@use"sass:meta";
@use"sass:list";
@use"sass:map";

/// GetStringFromList - Returns an string  from a list.
/// @author Jordan Vezina(staticBanter)
/// 
/// @access public
/// @group functions.helper
/// @since v0.2.0 - Development
/// @require {function} CheckVariableConstraints <./dist/scss/functions/_CheckVarConstraints.func.scss>
/// @param {string} $level - The level of error(Warning... Error... Other...)
/// @param {string|map} $code - The error code related to that message. If list first item is main code, the rest are 
/// sub-codes in order of precedence.
/// @throws - TODO : INSERT ERROR CODES.
/// @returns {string|bool} - Returns a string. If no message was found in the list, returns false.
@function GetStringFromList($code, $messageList){

    
    @if not CheckVariableConstraints($check:$messageList,$againstType:list,$min:1,$fullList:true) and not CheckVariableConstraints($check:$messageList,$againstType:map,$min:1,$fullList:true){
        @error(CreateLogMessage($code:("IvA","C"),$messageList:$errorMap,$messageOps:(("messageList","GetStringFromList"),null)));
    }

    @if not CheckVariableConstraints($check:$code,$againstType:string,$min:1) and not CheckVariableConstraints($check:$code,$againstType:list,$min:1){
        @error(CreateLogMessage($code:("IvA","C"),$messageList:$errorMap,$messageOps:(("code","GetStringFromList"),null)));
    }


    $listType:meta.type-of($messageList);
    

    $hasSubCode:false; // True if there is a sub code.
    
    // If the code type is a list
    @if(meta.type-of($code) == "list"){

        @if(list.nth($code,2)){
            $hasSubCode:true;
        }

    }
    

    // If the error list is an actual list,
    // Use a foreach style to get the message.
    // Else if the error list is a map,
    // Use map methods to get the message.
    // Else the list wasn't a valid type.
    // ^Yes constraints checks this, 
    // may remove the extra else.
    @if($listType == "map"){

        // If there is a sub code,
        // Include an extra loop to check
        // the subCode.
        @if($hasSubCode){

            @each $subCode, $message in map.get($messageList,list.nth($code,1)){

                @if($subCode == list.nth($code,2)){
                    @return($message);
                }

            }

        }@else{

            @return map.get($messageList,list.nth($code,1));
            
        }

    }@else if($listType == "list"){

        @if($hasSubCode){

            @each $errCode, $subErrs in $messageList {

                @if($errCode == $code){
        
                    @each $subErrCode, $subErrMessage in $subErrs{
        
                        @if($subErrCode == $subCode){
                            @return $subErrMessage;
                        }
        
                    } 
        
                }
            }

        }@else{

            @each $errCode,$errMessage in $messageList {

                @if($errCode == $code){
                    @return $errMessage;
                }

            }

        }

    }@else{
        @error(CreateLogMessage($code:("GE","IvLT"),$messageList:$errorMap,$messageOps:(null,null)));
    }

    @return false;
    
}